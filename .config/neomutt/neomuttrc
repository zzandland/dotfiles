# Minimal configuration for Neomutt/Mutt and Gmail/G Suite

# Decrypts passwords quietly
# see: https://wiki.archlinux.org/index.php/Mutt#Passwords_management
source "gpg -dq $HOME/.config/neomutt/pwd.gpg |"

# apply gruvbox colorscheme
source gruvbox.muttrc

# Username and password for your Gmail/G Suite account
set imap_user = "zzandland@gmail.com"
# Password assigned from decrypted file
set imap_pass = $my_pass

# Specifies the default location of your mailboxes
set folder = "imaps://imap.gmail.com:993"

# Configure Simple Mail Transfer Protocol for sending mail
# for Gmail
set smtp_url = "smtp://zzandland@smtp.gmail.com:587"
# for G Suite with own domain
set smtp_pass = $my_pass

# Location of inbox
set spoolfile = "+Primary"
# Location of drafts
set postponed = "+[GMail]/Drafts"
# Index format
set index_format = "%3C %<[y?%<[m?%<[d?%[%H:%M ]&%[%a %d]>&%[%b %d]>&%[%m/%y ]> %-20.20L %s"
# Most recent mail on top
set sort = "reverse-date"

# Activate caching, as it can greatly improve speed
set header_cache = "~/.mutt/cache/headers"
set message_cachedir = "~/.mutt/cache/bodies"

set realname = "Si Yong Kim"
set from = "zzandland@gmail.com"
set use_from = yes

set query_command= "mail-query '%s' ~/.mutt/cache/headers | perl -CS -MEncode -ne 'print decode(\"MIME-Header\", $_)'"

# horizontally split index and body
set pager_index_lines   = 10    # number of index lines to show
set pager_context       = 3     # number of context lines to show

# set editor to neovim
set editor = "nvim +':set textwidth=0' +':set wrapmargin=0' +':set wrap'"
# use utf-8
set charset = "utf-8"
# Disable saving outgoing mail since Gmail saves them by default.
set record = ""

# prefer plain text
alternative_order text/html text/plain text/enriched

auto_view text/html

# run viewer defined in mailcap by <return> in attach view
# bind attach <return> chromium

# mailcap file to use
set mailcap_path="~/.config/neomutt/mailcap"

# sidebar section
set folder = "imaps://imap.gmail.com:993"
set sidebar_visible
set imap_check_subscribed=yes
set sidebar_width = 25
set sidebar_short_path=yes
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set mail_check_stats = yes

# key bindings
bind index G imap-fetch-mail
bind index,pager <Up> sidebar-prev
bind index,pager <Down> sidebar-next
bind index,pager <Right> sidebar-open
bind pager j next-line
bind pager k previous-line
bind pager \Cd next-page
bind pager \cu previous-page
bind pager \Cj next-entry
bind pager \Ck previous-entry
macro index,pager \Cv "<view-attachments><search>text/html<enter><view-mailcap><exit>"
